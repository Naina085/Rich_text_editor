<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Text Editor with Unique IDs</title>
  <style>
    #textArea {
      width: 100%;
      height: 300px;
      border: 1px solid #ccc;
      padding: 10px;
      margin-top: 10px;
      overflow-y: auto;
    }

    .toolbar button {
      margin-right: 10px;
      padding: 5px 10px;
    }
  </style>
</head>
<body>

  <div class="toolbar">
    <button onclick="insertHeading()">Insert Heading</button>
    <button onclick="insertParagraph()">Insert Paragraph</button>
  </div>

  <div id="textArea" contenteditable="true"></div>

  <script>
    let uniqueIdCounter = 0;

    function generateUniqueId(tagName) {
      uniqueIdCounter++;
      return `${tagName.toLowerCase()}-${uniqueIdCounter}`;
    }

    function insertHeading() {
      const heading = document.createElement("h1");
      heading.textContent = "This is a Heading";
      heading.id = generateUniqueId("h1");

      insertElementAtCursor(heading);
    }

    function insertParagraph() {
      const paragraph = document.createElement("p");
      paragraph.textContent = "This is a paragraph.";
      paragraph.id = generateUniqueId("p");

      insertElementAtCursor(paragraph);
    }

    function insertElementAtCursor(element) {
      const selection = window.getSelection();
      if (!selection.rangeCount) return;

      const range = selection.getRangeAt(0);
      range.collapse(false);
      range.insertNode(element);

      // Move cursor after the inserted element
      range.setStartAfter(element);
      range.setEndAfter(element);
      selection.removeAllRanges();
      selection.addRange(range);
    }

    const textArea = document.getElementById("textArea");

    // Log updated content and assign IDs if missing
    textArea.addEventListener("input", () => {
      const tags = textArea.querySelectorAll("h1, h2, h3, p, ul, ol, li");

      tags.forEach(tag => {
        if (!tag.id) {
          tag.id = generateUniqueId(tag.tagName);
        }
      });

      console.log("Updated content:", textArea.innerHTML);
    });
  </script>

</body>
</html>
